# Парсинг Индекса Тинькофф

![index](./img/index.png)

Программное решение, которое:
* Парсит данные для всех доступных регионов РФ и всей РФ (список ```regs``` в файле ```main.py```) с сайта [Tinkoff CoronaIndex](https://index.tinkoff.ru/):
  * "Кансомеры": индекс "Траты потребителей", "Разнообразие покупок" и категории (список ```consumer_types``` в файле ```main.py```);
  * "Бизнес": индекс "Обороты бизнеса" и категории (список ```business_types``` в файле ```main.py```).
* Формирует ```pd.DataFrame()``` в формате плоской таблицы;
* Проверяет наличии старых файлов в корневой директории проекта, в случае их наличия - удяляет;
* Сохряняет новые полученные данные в файлы MS Excel "Tinkoff_Index_Customers_2024_2024.xlsx" и "Tinkoff_Index_Business_2024_2024.xlsx" для "Кансомеров" и "Бизнеса" соответсвенно;
* Для регионов ЦФО (список ```regions``` в файле ```main.py```) рассчитываются среднемесячные значения за период с начала публикации индекса (01.2020) за счет объеденения с данными из архива (дирректория ```/archive``` в корневой папке), где хранятся данные с 2020 по 2023 год ("Tinkoff_Index_Customers_2020_2023.xlsx" и "Tinkoff_Index_Business_2020_2023.xlsx" для "Кансомеров" и "Бизнеса" соответсвенно);
* Проверяет наличии старого файла в корневой директории проекта, в случае его наличия - удяляет;
* Сохряняет новые полученные данные в файлы MS Excel "Tinkoff_Index_monthly_averages.xlsx".

<!--Установка-->
## Установка
У вас должны быть установлены [зависимости проекта](https://github.com/das1204/Tinkoff-Index#зависимости)

1. Клонирование репозитория 

```git clone https://github.com/das1204/Tinkoff-Index.git```

2. Переход в директорию Tinkoff-Index

```cd Tinkoff-Index```

3. Установка зависимостей

```pip install -r requirements.txt```

4. Запуск скрипта для демонстрации работы

```python main.py```

<!--зависимости-->
## Зависимости
Эта программа зависит от интепретатора Python версии 3.9 или выше.

## Обновление архива

В 2025 году (и в последующих) необходимо в файле ```main.py```:
* Закоментировать строки 343-345;
* В строке 12 ```datetime(2024, 1, 1)``` заменить на ```datetime(2020, 1, 1)```;
* В строке 14 ```date.today()``` заменить на ```datetime(2024, 12, 1)```;
* После выполнения кода в корневой папке образуются файлы MS Excel "Tinkoff_Index_Customers_2020_2024.xlsx" и "Tinkoff_Index_Business_2020_2024.xlsx" для "Кансомеров" и "Бизнеса" соответсвенно, которыми надо заменить файлы в папке ```/archive```;
* После чего разкоментировать строки 343-345;
* В строке 12 ```datetime(2020, 1, 1)``` заменить на ```datetime(2025, 1, 1)```;
* В строке 14 ```datetime(2024, 12, 1)``` заменить на ```date.today()```.
